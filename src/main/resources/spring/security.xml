<beans:beans xmlns='http://www.springframework.org/schema/security'
	xmlns:beans='http://www.springframework.org/schema/beans' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
	xsi:schemaLocation='http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security.xsd'>
	<http pattern='/styles/*' security='none' />
	<http pattern='/images/*' security='none' />
	<http pattern='/scripts/*' security='none' />
	<http use-expressions='true'>
		<form-login login-page="/klanten/login" authentication-failure-url="/klanten/login?error=true" />
		<logout/>
	</http>
	<authentication-manager>
		<authentication-provider>
			<jdbc-user-service data-source-ref="dataSource"
			users-by-username-query="select emailadres as username, wachtwoord as password, actief as enabled
from gebruikers
where emailadres = ?"
	authorities-by-username-query="select gebruikers.emailadres as username, rollen.naam as authorities
from gebruikers inner join gebruikersrollen
on gebruikers.gebruikerid = gebruikersrollen.gebruikerid
inner join rollen
on rollen.rolId = gebruikersrollen.rolid
where gebruikers.emailadres=?"/>
		</authentication-provider>
	</authentication-manager>
</beans:beans>